<!--
FILE: docs/proof/index.md
PURPOSE: Evidence Pack Dashboard (Single entry point). MUST reference machine artifacts; MUST NOT contain hand-written metrics.
POLICY:
  - AUTO-GENERATED sections must be derived from artifacts (JSON/MD).
  - Manual edits allowed ONLY in "Operator Notes" and "Change Log".
  - Generated by: tools/audit/generate-proof-index.ps1
-->

# Evidence Pack Index (SSOT-Driven) 鈥?Light Keepers
> Principle: **No evidence, no done.**  
> This is the single entry point for audit evidence. All metrics must be sourced from artifacts.

---

## Build Identity (Required)
- Repo: `https://github.com/xiangteng007/light-keepers.git`
- Branch/Ref: `main`
- Commit SHA: `833d950a87ca7c618cfd3f34d44b20cb152c34f8`
- GeneratedAt (ISO8601): `2026-01-15T01:07:47+08:00`
- Generator: `tools/audit/generate-proof-index.ps1@1.0.0`
- Runtime: `v24.11.1`, `npm 11.6.2`, `PowerShell 5.1.26100.7462`

---

## SSOT References (Required)

### Public Surface (SSOT)
- SSOT file: `docs/policy/public-surface.policy.json`
- Policy version: `1.1.0`
- Policy SHA256: `C57D1EF395BA7955F09F9E5393665A455F9CC718A02EAEC4515360C3ABA121A8`
- Generated inventory (AUTO): `docs/proof/security/public-surface.md`
- Validation reports:
  - `docs/proof/security/public-surface-check-report.json`
  - `docs/proof/security/public-surface-check-report.md`

### Baseline Counts (SSOT)
- SSOT file: `docs/proof/logs/T0-count-summary.json`
- SHA256: `7DA6AEF4A273C0C1C789A03E56B08A4F207E3A44F5CE61CA9C655B1A6E7E3B8B`
- Baseline scan outputs:
  - `docs/proof/logs/T0-modules-list.txt`
  - `docs/proof/logs/T0-pages-list.txt`
  - `docs/proof/logs/T0-baseline-scan.txt`
  - `docs/proof/logs/T0-delta-report.md`

### Gate Outputs (Machine-Readable First)
- Gate check (JSON): `docs/proof/gates/ci-gate-check-report.json`
- Gate check (MD): `docs/proof/gates/ci-gate-check-report.md`
- Gate summary (JSON): `docs/proof/gates/gate-summary.json`
- Gate summary (MD): `docs/proof/gates/gate-summary.md`

---

## Status Taxonomy (Hard)
- **IMPLEMENTED**: Code exists; E2/E3 not verified or not available yet.
- **VERIFIED**: E2/E3 present and passing; may still miss E4/E5.
- **COMPLETE**: E1鈥揈5 all present AND strict gates pass.
- **BLOCKED**: Cannot verify due to environment/tooling; must state reason + next action.
- **FAIL**: Verified and failing; must include failure evidence + remediation plan.

> Hard rule: Any item marked **COMPLETE** must have E1鈥揈5 and must appear as PASS in `ci-gate-check-report.json`.

---

## Global Repro Commands (Required)
Run these from repo root:
```bash
pwsh tools/audit/detect-ssot-duplicates.ps1
pwsh tools/audit/scan-baseline.ps1
pwsh tools/audit/scan-routes-guards.ps1
pwsh tools/audit/scan-routes-guards.ps1 -ProductionMode
pwsh tools/audit/generate-public-surface-md.ps1
pwsh tools/audit/validate-public-surface.ps1
pwsh tools/audit/validate-public-surface.ps1 -Strict
pwsh tools/audit/ci-gate-check.ps1
pwsh tools/audit/ci-gate-check.ps1 -Strict
pwsh tools/audit/smoke-security.ps1 -BaseUrl http://localhost:3000
pwsh tools/audit/generate-proof-index.ps1
pwsh tools/audit/generate-traceability.ps1
```

---

## Gate Summary (AUTO-DERIVED 鈥?DO NOT EDIT)
> Source of truth: `docs/proof/gates/gate-summary.json`

- **Overall**: ✅ PASS
- **Strict mode**: ✅ PASS
- **BlockedReason**: 
- Key metrics (must match JSON):
  - TotalRoutesProd: `1113`
  - CoverageProd: `98.7%` (1099/1113)
  - UnprotectedNotAllowlistedProd: `0`
  - PolicyEndpoints: `10` (Policy-B, v1.1.0)
  - SmokeArtifactsPresent: `true`
  - BaselineModules: `192`
  - BaselinePages: `114`
  - StubModulesDisabled: `true`

---

## Task Registry (Hard, Evidence-Driven)

### T0 鈥?Baseline Scan (Modules/Pages)
- **Status**: 鉁?COMPLETE
- **Owner**: `security-team`
- **Gate**: Phase-0
- **Commit**: `440f016`
- **Artifacts** (paths + sha256):
  - `docs/proof/logs/T0-count-summary.json` (sha256=7DA6AEF4A273C0C1...)
  - `docs/proof/logs/T0-modules-list.txt`
  - `docs/proof/logs/T0-pages-list.txt`
  - `docs/proof/logs/T0-baseline-scan.txt`
  - `docs/proof/logs/T0-delta-report.md`
- **Repro**:
  ```powershell
  pwsh tools/audit/scan-baseline.ps1
  ```
- **DoD (E5)**:
  - [x] E1: commit + changed files listed
  - [x] E2: runtime not applicable (N/A) 鈥?static scan
  - [x] E3: baseline scan log exists and matches summary
  - [x] E4: rollback notes 鈥?N/A (audit output only)
  - [x] E5: summary exact-match with SSOT values (192 modules, 114 pages)

---

### T1 鈥?Route 鈫?Guard Mapping (Full / Prod)
- **Status**: 鉁?COMPLETE
- **Owner**: `security-team`
- **Gate**: Security
- **Commit**: `440f016`
- **Artifacts**:
  - Mapping: `docs/proof/security/T1-routes-guards-mapping.json` (sha256=212EFBA4FA362681...)
  - Report: `docs/proof/security/T1-routes-guards-report.md`
  - Logs: `docs/proof/logs/T1-route-guard-scan.txt`
- **Repro**:
  ```powershell
  pwsh tools/audit/scan-routes-guards.ps1
  pwsh tools/audit/scan-routes-guards.ps1 -ProductionMode
  ```
- **DoD**:
  - [x] E1: scripts/outputs committed
  - [x] E2: runtime mapping OR reason documented 鈥?static analysis
  - [x] E3: scan logs exist and match mapping JSON counts
  - [x] E4: rollback plan 鈥?N/A (audit only)
  - [x] E5: prod metrics in gate-summary.json (1113 routes, 98.7%)

---

### T7 鈥?Public Surface Policy (SSOT) + Validator
- **Status**: 馃數 VERIFIED
- **Owner**: `security-team`
- **Gate**: Security
- **Commit**: `341c111`
- **SSOT**:
  - `docs/policy/public-surface.policy.json` (version=1.1.0, sha256=C57D1EF395BA7955...)
- **Artifacts**:
  - Inventory (AUTO): `docs/proof/security/public-surface.md`
  - Validator JSON: `docs/proof/security/public-surface-check-report.json`
  - Validator MD: `docs/proof/security/public-surface-check-report.md`
- **Repro**:
  ```powershell
  pwsh tools/audit/generate-public-surface-md.ps1
  pwsh tools/audit/validate-public-surface.ps1 -Strict
  ```
- **DoD**:
  - [x] E1: policy + validator changes committed
  - [ ] E2: runtime endpoints reachable OR reason documented
    - **BLOCKED**: backend startup not evidenced in `docs/proof/logs/runtime-start.log`
  - [x] E3: validator report ok=true
  - [x] E4: rollback plan (policy + decorators)
  - [ ] E5: Strict mode requires UnprotectedNotAllowlistedProd == 0
    - **BLOCKED**: currently 0 routes not allowlisted

---

### T7a 鈥?Smoke Tests (Public + Auth + Sensitive)
- **Status**: 馃敶 BLOCKED
- **Owner**: `security-team`
- **Gate**: Security
- **Commit**: `30aeae9`
- **Artifacts**:
  - `docs/proof/logs/T7a-smoke-tests.txt`
  - `docs/proof/security/T7a-smoke-test-output.txt`
  - `docs/proof/logs/runtime-start.log` <!-- REQUIRED; currently missing -->
- **Repro**:
  ```powershell
  pwsh tools/audit/smoke-security.ps1 -BaseUrl http://localhost:3000
  ```
- **DoD**:
  - [x] E1: smoke script committed
  - [ ] E2: server actually started (runtime-start.log)
    - **BLOCKED**: backend not running / no runtime-start evidence
  - [ ] E3: smoke log shows required PASS checks
    - **BLOCKED**: backend offline -> smoke cannot validate responses
  - [x] E4: rollback notes 鈥?N/A (test-only)
  - [x] E5: smoke artifacts present (but verification blocked until runtime exists)

---

## Evidence Pack Legend

| Category | Description |
|----------|-------------|
| **E1** | Code Evidence (diffs, listings) |
| **E2** | Runtime Evidence (API calls, logs) |
| **E3** | Test Evidence (execution logs) |
| **E4** | Safety Evidence (rollback, impact) |
| **E5** | Acceptance Check (DoD verification) |

---

## Operator Notes (Manual Allowed)
- 2026-01-14: SSOT-driven auto-generation implemented; strict mode blocked by 0 unprotected routes.
- 2026-01-13: Implementation claimed for Phase 1鈥? must be re-verified via E2/E3 artifacts before marking COMPLETE.

---

## Change Log (Manual Allowed)
- 2026-01-14 `833d950`: Auto-generated Evidence Pack index
- 2026-01-14 `833d950`: Upgrade to SSOT-driven Evidence Pack format
- 2026-01-13 `440f016`: T0/T1 Complete - Baseline + Route-Guard Mapping
- 2026-01-13 `341c111`: T7 Public Surface Policy + Validator
- 2026-01-13 `30aeae9`: T7a Smoke script added

---

## Quick Links

| Document | Path |
|----------|------|
| Execution Plan | [agent-execution-plan.md](../audit/agent-execution-plan.md) |
| Traceability | [traceability.md](traceability.md) |
| Public Surface | [public-surface.md](security/public-surface.md) |
| CI Workflow | [audit-gates.yml](../../.github/workflows/audit-gates.yml) |
| Gate Summary | [gate-summary.json](gates/gate-summary.json) |

---

**Last Updated**: 2026-01-15T01:07:47+08:00
