<!--
FILE: docs/proof/traceability.md
PURPOSE: Requirement-to-Evidence Traceability Matrix (RTM). MUST be internally consistent; summary must be generated.
POLICY: Each row MUST include ReqID, source, tasks, commit, evidence paths, status.
GENERATED BY: tools/audit/generate-traceability.ps1
-->

# Traceability Matrix (RTM) 鈥?Light Keepers
> This matrix maps requirements to implementation tasks and evidence artifacts.  
> Hard rule: Any PASS claim without E2/E3 evidence (unless explicitly N/A) is invalid.

---

## Build Identity (Required)
- Repo: `https://github.com/xiangteng007/light-keepers.git`
- Branch/Ref: `main`
- Commit SHA: `4515b66e6cf71da0c05863df3520f1fd15b5962c`
- GeneratedAt (ISO8601): `2026-02-02T01:28:59+08:00`
- Generator: `tools/audit/generate-traceability.ps1@1.0.0`

---

## Legend (Hard)

### Requirement Status (Row-level)
- **PASS**: Verified by evidence (E2/E3 required unless explicitly N/A).
- **FAIL**: Verified and failing; remediation required.
- **PENDING**: Implemented and/or planned but not evidenced.
- **BLOCKED**: Cannot verify due to environment; must state reason + next action.

### Pipeline Status (Task-level)
- IMPLEMENTED / VERIFIED / COMPLETE / BLOCKED / FAIL (must match `docs/proof/index.md`)

---

## Summary Statistics (AUTO-DERIVED 鈥?DO NOT EDIT)
> Source of truth: computed from rows below.

- Total requirements: `13`
- PASS: `6` | FAIL: `0` | PENDING: `5` | BLOCKED: `2`
- By domain:
  - ICS/C2: PASS `0` / PENDING `3` / FAIL `0` / BLOCKED `0`
  - Security: PASS `1` / PENDING `1` / FAIL `0` / BLOCKED `2`
  - Deprecation: PASS `5` / PENDING `1` / FAIL `0` / BLOCKED `0`

---

## Requirements Table (Hard Format)

### Domain: ICS/C2 (Disaster / Association Ops)
| ReqID | Requirement | Source | Tasks | Commit | Evidence Paths | Status | Notes |
|---|---|---|---|---|---|---|---|
| ICS-C2-001 | SITREP/IAP generation is supported and reproducible | `01-gap-analysis.md#GAP-A-M1` | `T2` | `de44a7a` | `E1: backend/src/.../command-chain.service.ts` | 鈴?PENDING | Code exists (E1) but missing E2/E3 (runtime/test). |
| ICS-C2-002 | Map-based dispatch supports GPS + task assignment + audit trail | `02-integration-map.md` | `T2,T5` | `d51fd8f` | `E1: backend/src/.../task-event.listeners.ts` | 鈴?PENDING | Requires E2 dispatch flow log + E3 scenario test. |
| ICS-C2-003 | Command chain modeling with 17 ICS roles | `01-gap-analysis.md#GAP-A-M3` | `T2` | `de44a7a` | `E1: backend/src/.../command-chain.entity.ts` | 鈴?PENDING | Data model exists; needs verification evidence. |

### Domain: Security & Governance
| ReqID | Requirement | Source | Tasks | Commit | Evidence Paths | Status | Notes |
|---|---|---|---|---|---|---|---|
| SEC-PUB-001 | Public surface is allowlisted by SSOT policy and strict validator | `docs/policy/public-surface.policy.json` | `T7` | `341c111` | `docs/proof/security/public-surface-check-report.json; docs/proof/security/public-surface.md` | 馃敶 BLOCKED | Strict blocked due to UnprotectedNotAllowlistedProd>0. |
| SEC-PUB-002 | Unprotected routes not allowlisted in production is zero | `docs/proof/security/T1-routes-guards-mapping.json` | `T1,T7` | `440f016` | `docs/proof/gates/gate-summary.json` | 鈴?PENDING | Must reach UnprotectedNotAllowlistedProd==0 to pass. |
| SEC-SMK-001 | Smoke tests verify public/auth/sensitive endpoints end-to-end | `.github/workflows/audit-gates.yml` | `T7a` | `30aeae9` | `docs/proof/logs/T7a-smoke-tests.txt` | 馃敶 BLOCKED | Backend runtime evidence missing. |
| SEC-GUARD-001 | Guard coverage is tracked and reported via gate-summary | `04-security-and-governance.md` | `T1` | `440f016` | `docs/proof/security/T1-routes-guards-mapping.json; docs/proof/gates/gate-summary.json` | 鉁?PASS | CoverageProd tracked in gate-summary.json. |

### Domain: Deprecation & Cleanup
| ReqID | Requirement | Source | Tasks | Commit | Evidence Paths | Status | Notes |
|---|---|---|---|---|---|---|---|
| DEPR-001 | Stub modules removed or excluded from production build | `03-deprecation-cleanup.md` | `T8` | `630430e` | `docs/proof/gates/gate-summary.json; backend/src/app.module.ts` | 鉁?PASS | gate-summary shows StubModulesDisabled=true. |

---

## Row Rules (Hard)
1) **Source** must be a stable file reference + anchor (or section name).
2) **Tasks** must reference Task IDs in `docs/proof/index.md`.
3) **Commit** must be a real git SHA (no placeholders in PASS rows).
4) **Evidence Paths**:
   - PASS rows must include at least one machine artifact under `docs/proof/**` (E2/E3).
   - E1-only (code path) is allowed only for PENDING/IMPLEMENTED states.
5) Summary must equal computed counts from this table; any mismatch should fail CI.

---

## Detailed Evidence Links (Optional)
- Gate Summary: [gate-summary.json](gates/gate-summary.json)
- Public Surface Inventory: [public-surface.md](security/public-surface.md)
- Public Surface Report: [public-surface-check-report.json](security/public-surface-check-report.json)
- Route Mapping: [T1-routes-guards-mapping.json](security/T1-routes-guards-mapping.json)

---

## Manual Notes (Allowed, non-authoritative)
- 2026-01-14: Auto-generated RTM with hard-evidence semantics (PASS requires E2/E3).
- 2026-01-13: ICS/C2 functional features require runtime scenarios before PASS.

---

**Last Updated**: 2026-02-02T01:28:59+08:00
