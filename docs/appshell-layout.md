# AppShell Layout ç‰ˆé¢è¦æ ¼ v3.0

> **ğŸ¯ ç³»çµ±æ¡†æ¶æœ€é«˜æº–å‰‡**  
> æ­¤æ–‡ä»¶ç‚º Lightkeepers å¹³å°çš„ UI æ¶æ§‹è¦ç¯„ï¼Œæ‰€æœ‰å‰ç«¯é–‹ç™¼å¿…é ˆéµå¾ªæ­¤è¦æ ¼ã€‚

**æœ€å¾Œæ›´æ–°**ï¼š2026-01-11

---

## ä½ˆå±€çµæ§‹åœ–

```
æ¡Œæ©Ÿ (â‰¥901px)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [H-L] Logo+Level     [H-C] ä¿ç•™      [H-R] ç·¨è¼¯æ§åˆ¶ | ğŸ””é€šçŸ¥ | ğŸ‘¤å¸³è™Ÿ        â”‚ 52px
â”œâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚[S-T]  â”‚                                                                      â”‚
â”‚ >>    â”‚                                                                      â”‚
â”‚[S-M]  â”‚                        [M] Widget Grid                               â”‚
â”‚ ğŸ“–ğŸ ğŸ‘¥ğŸ””â”‚                                                                      â”‚
â”‚[S-B]  â”‚                                                                      â”‚
â”‚ âš™ è¨­å®šâ”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  52px                              flex: 1

æ‰‹æ©Ÿ (<901px)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [H-L] Burger+Logo    [H-C]              [H-R] ç·¨è¼¯ | ğŸ”” | ğŸ‘¤                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                              [M] MainColumn                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                           [MB] MobileBottom 72px                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Header [H] å€å¡Š

| å€å¡Š | å…§å®¹ | å°é½Š |
|------|------|------|
| H-L | LIGHTKEEPERS + Level æ¨™ç±¤ | å·¦ |
| H-C | ä¿ç•™å€åŸŸ | ä¸­ |
| H-R | ç·¨è¼¯æ§åˆ¶ + é€šçŸ¥ + å¸³è™Ÿ | å³ |

### H-R æ§åˆ¶é …é…ç½®

å¾å·¦åˆ°å³æ’åˆ—é †åºï¼š

| é †åº | å…ƒç´  | å¯è¦‹æ€§ | åŠŸèƒ½ |
|------|------|--------|------|
| 1 | WidgetEditControls | Level 5 å°ˆç”¨ | ç·¨è¼¯/æ–°å¢/é‡ç½® Widget |
| 2 | ğŸ”” é€šçŸ¥åœ–ç¤º | å…¨ç”¨æˆ¶ | é»æ“Šå½ˆå‡ºé€šçŸ¥å°å¡ |
| 3 | ğŸ‘¤ å¸³è™Ÿé ­åƒ | å…¨ç”¨æˆ¶ | é»æ“Šå½ˆå‡ºå¸³è™Ÿå°å¡ |

### å½ˆå‡ºå°å¡è¦æ ¼

```css
/* é€šç”¨å°å¡æ¨£å¼ */
.popup-card {
    position: absolute;
    top: 100%;
    right: 0;
    margin-top: 8px;
    background: var(--layout-bg, #0b111b);
    border: 1px solid var(--accent-gold, #d4a84b);  /* é‡‘è‰²é‚Šæ¡† */
    border-radius: 12px;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.4);
    z-index: 200;
    padding: 16px;
}
```

| å°å¡ | å¯¬åº¦ | å…§å®¹ |
|------|------|------|
| é€šçŸ¥ | 300px | æ¨™é¡Œ + é€šçŸ¥åˆ—è¡¨ |
| å¸³è™Ÿ | 240px | ç”¨æˆ¶è³‡è¨Š + å‰å¾€å¸³æˆ¶è¨­å®šæŒ‰éˆ• |

---

## Sidebar [S] å€å¡Š

### å°ºå¯¸

| ç‹€æ…‹ | å¯¬åº¦ | èªªæ˜ |
|------|------|------|
| æ”¶åˆ | 52px | èˆ‡ Header é«˜åº¦ä¸€è‡´ |
| å±•é–‹ | 280px | é¡¯ç¤ºåœ–ç¤º + æ–‡å­—æ¨™ç±¤ |

### çµæ§‹

| å€å¡Š | å…§å®¹ | é«˜åº¦ | èªªæ˜ |
|------|------|------|------|
| S-T (sbTop) | `>>` å±•é–‹æŒ‰éˆ• | auto | é»æ“Šåˆ‡æ›æ”¶åˆ/å±•é–‹ |
| S-M (sbScroll) | å‹•æ…‹å°èˆªé …ç›® | flex:1 | å¯é€éè¨­å®šç·¨è¼¯é †åºèˆ‡åç¨± |
| S-B (sbBottom) | âš™ è¨­å®šæŒ‰éˆ• | **52px** | èˆ‡ Header åŒé«˜ï¼Œé»æ“Šé–‹å•Ÿè¨­å®š |

### å±•é–‹/æ”¶åˆæŒ‰éˆ•

- åœ–ç¤ºï¼š`ChevronsRight`ï¼ˆæ”¶åˆæ™‚ï¼‰/ `ChevronsLeft`ï¼ˆå±•é–‹æ™‚ï¼‰
- å°ºå¯¸ï¼š20px
- å›ºå®šå¤§å°ï¼š40px Ã— 40px

### å°èˆªè¨­å®šåŠŸèƒ½

é€é Sidebar åº•éƒ¨è¨­å®šæŒ‰éˆ•é–‹å•Ÿ `SidebarSettings` Modalï¼š

| åŠŸèƒ½ | èªªæ˜ |
|------|------|
| ç·¨è¼¯åç¨± | é»æ“Šé …ç›®åç¨±é€²å…¥ç·¨è¼¯æ¨¡å¼ |
| æ‹–æ”¾æ’åº | æ‹–æ›³é …ç›®èª¿æ•´é †åº |
| é¡¯ç¤º/éš±è— | åˆ‡æ›é …ç›®å¯è¦‹æ€§ |
| **RBAC ç­‰ç´š** | èª¿æ•´æ¯é …æœ€ä½æ¬Šé™ç­‰ç´š (L0-L5) |
| é‡ç½® | é‚„åŸç‚ºé è¨­é…ç½® |
| æŒä¹…åŒ– | localStorage å„²å­˜ |

### 7 å€‹å·¥ä½œæµåŸŸï¼ˆ33 é é¢ï¼‰

| åŸŸ | ä»£ç¢¼ | åœ–ç¤º | é é¢æ•¸ |
|----|------|------|--------|
| C2 | æŒ‡æ®æ§åˆ¶ | `Zap` | 7 |
| Geo | åœ°ç†æƒ…è³‡ | `Map` | 5 |
| Log | å¾Œå‹¤è³‡æº | `Package` | 4 |
| HR | äººåŠ›å‹•å“¡ | `Users` | 5 |
| Community | ç¤¾å€æ²»ç† | `Building2` | 3 |
| Analytics | åˆ†æå ±è¡¨ | `BarChart3` | 3 |
| Core | å¹³å°æ²»ç† | `Settings` | 6 |

---

## CSS è®Šæ•¸

```css
:root {
    /* å°ºå¯¸ */
    --header-h: 52px;
    --sidebar-w-collapsed: 52px;  /* èˆ‡ header åŒé«˜ */
    --sidebar-w-expanded: 280px;
    --mobile-bottom-h: 72px;
    --gutter: 12px;
    
    /* é¡è‰² */
    --layout-bg: #0b111b;
    --accent-gold: #d4a84b;
    --border-subtle: rgba(255, 255, 255, 0.06);
    --text-primary: #e8eaed;
    --text-secondary: #9aa0a6;
    --text-muted: #5f6368;
}
```

---

## z-index å±¤ç´š

| å…ƒç´  | å€¼ | èªªæ˜ |
|------|----|----|
| Header | 100 | é ‚éƒ¨å›ºå®š |
| Popups (é€šçŸ¥/å¸³è™Ÿå°å¡) | 200 | Header å½ˆå‡ºå±¤ |
| Modal (Picker/Settings) | 210 | æ¨¡æ…‹å°è©±æ¡† |
| Scrim | 200 | é®ç½©å±¤ |
| Drawer | 300 | æŠ½å±œé¸å–® |
| Sidebar Settings overlay | 400-401 | è¨­å®šå½ˆçª— |

---

## æª”æ¡ˆå°æ‡‰

| å…ƒä»¶ | æª”æ¡ˆ | èªªæ˜ |
|------|------|------|
| Shell | `AppShellLayout.tsx/css` | ä¸»æ¡†æ¶å®¹å™¨ |
| Grid | `WidgetGrid.tsx/css` | Widget ç¶²æ ¼ç³»çµ± |
| Widget | `Widget.tsx/css` | Widget å®¹å™¨èˆ‡æ§åˆ¶ |
| Picker | `WidgetPicker.tsx/css` | Widget é¸æ“‡å™¨ |
| Hook | `useWidgetLayout.ts` | Widget ç‹€æ…‹ç®¡ç† |
| Sidebar Config | `useSidebarConfig.ts` | å´é‚Šæ¬„é…ç½® Hook |
| Sidebar Settings | `SidebarSettings.tsx/css` | å´é‚Šæ¬„è¨­å®š Modal |

---

## æ¬Šé™æ§åˆ¶

| åŠŸèƒ½ | Level 5 (SystemOwner) | å…¶ä»–ç”¨æˆ¶ |
|------|----------------------|----------|
| ç·¨è¼¯ Widget ä½ˆå±€ | âœ… | âŒ |
| æ–°å¢/ç§»é™¤ Widget | âœ… | âŒ |
| é‡ç½®ä½ˆå±€ | âœ… | âŒ |
| ç·¨è¼¯ Sidebar å°èˆª | âœ… | âŒ |
| é€šçŸ¥åŠŸèƒ½ | âœ… | âœ… |
| å¸³è™Ÿè¨­å®š | âœ… | âœ… |

---

## éŸ¿æ‡‰å¼æ–·é»

| æ–·é» | è¡Œç‚º |
|------|------|
| â‰¥901px | æ¡Œæ©Ÿç‰ˆï¼Œé¡¯ç¤º Sidebar |
| <901px | æ‰‹æ©Ÿç‰ˆï¼Œéš±è— Sidebarï¼Œé¡¯ç¤º MobileBottom |
| <480px | æ¥µå°è¢å¹•å„ªåŒ– |
